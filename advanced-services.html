

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Advanced Services &mdash; Elassandra Operator Documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://media.readthedocs.org/css/sphinx_rtd_theme.css" type="text/css" />
  <link rel="stylesheet" href="https://media.readthedocs.org/css/readthedocs-doc-embed.css" type="text/css" />
  <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script src="_static/custom.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Operations" href="operations.html" />
    <link rel="prev" title="Provision a Datacenter" href="provisioning.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Elassandra-Operator
          

          
            
            <img src="_static/elassandra-operator.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="helm-setup.html">HELM setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="operator-setup.html">Operator setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="provisioning.html">Provision a Datacenter</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Advanced Services</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#managed-keyspaces">Managed Keyspaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="#continuous-cassandra-repair">Continuous Cassandra repair</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#address-translation">Address translation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#kibana-visualisation">Kibana visualisation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="operations.html">Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="multi-dc.html">Mutli-datacenter deployment</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Elassandra-Operator</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Advanced Services</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/advanced-services.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="advanced-services">
<h1>Advanced Services<a class="headerlink" href="#advanced-services" title="Permalink to this headline">¶</a></h1>
<div class="section" id="managed-keyspaces">
<h2>Managed Keyspaces<a class="headerlink" href="#managed-keyspaces" title="Permalink to this headline">¶</a></h2>
<p>The Elassandra-Operator can manage Cassandra keyspace replication for you:</p>
<ul class="simple">
<li><p>Create keyspace if not exists, create Cassandra role and setup Cassandra permissions and Elasticsearch privileges.</p></li>
<li><p>Adjust the replication factor and run automatic repair/cleanup when Elassandra nodes are added or removed, or when a datacenter is added or removed.</p></li>
<li><p>Register the keyspace into Cassandra Reaper to schedule continuous repairs.</p></li>
</ul>
<p>Like the <a class="reference external" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/index-modules.html#dynamic-index-settings">Elasticsearch index.auto_expand_replicas</a>
index settings, the Elassandra-Operator automatically adjust the keyspace replication factor to the desired number of copies and the current number of nodes in the datacenter:</p>
<p>To create a Cassandra role, the Elassandra operator retreives its password in a Kubernetes secret named <code class="docutils literal notranslate"><span class="pre">elassandra-[cluster_name]-keyspace</span></code> by default, with
a secret key equals to the role name or specified by the <code class="docutils literal notranslate"><span class="pre">secretKey</span></code> field, as shown below. Specify a <code class="docutils literal notranslate"><span class="pre">secretName</span></code> to use an alternate Kubernetes secret.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kubectl</span> <span class="n">create</span> <span class="n">secret</span> <span class="n">generic</span> <span class="n">elassandra</span><span class="o">-</span><span class="n">cl1</span><span class="o">-</span><span class="n">keyspaces</span> <span class="o">-</span><span class="n">n</span> <span class="n">mynamespace</span> <span class="o">--</span><span class="n">from</span><span class="o">-</span><span class="n">literal</span><span class="o">=</span><span class="n">gravitee</span><span class="o">=</span><span class="s1">&#39;xxxxxxx&#39;</span>
</pre></div>
</div>
<p>Specify a managed keyspace in your datacenter CRD as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="n">managedKeyspaces</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">keyspace</span><span class="p">:</span> <span class="n">gravitee</span>
    <span class="n">rf</span><span class="p">:</span> <span class="mi">3</span>
    <span class="n">role</span><span class="p">:</span> <span class="n">gravitee</span>
    <span class="n">login</span><span class="p">:</span> <span class="n">true</span>
    <span class="n">superuser</span><span class="p">:</span> <span class="n">false</span>
    <span class="n">secretKey</span><span class="p">:</span> <span class="n">gravitee</span>
    <span class="n">repair</span><span class="p">:</span> <span class="n">true</span>
    <span class="n">grantStatements</span><span class="p">:</span>
      <span class="o">-</span> <span class="s2">&quot;GRANT gravitee TO gravitee&quot;</span>
</pre></div>
</div>
<p>Check you keyspace is properly managed in the datacenter status:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">status</span><span class="p">:</span>
  <span class="o">...</span>
  <span class="n">keyspaceManagerStatus</span><span class="p">:</span>
    <span class="n">keyspaces</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">_kibana</span>
    <span class="o">-</span> <span class="n">gravitee</span>
</pre></div>
</div>
</div>
<div class="section" id="continuous-cassandra-repair">
<h2>Continuous Cassandra repair<a class="headerlink" href="#continuous-cassandra-repair" title="Permalink to this headline">¶</a></h2>
<p>In order to ensure data consistency, a continuous cassandra repair can be managed by a <a class="reference external" href="https://http://cassandra-reaper.io/">Cassandra Reaper</a>
instance running on each datacenter. The Elassandra-Operator automatically configure Cassandra Reaper,
register the Cassandra cluster and schedule repairs for managed keyspaces.</p>
<img alt="_images/reaper-cluster.png" src="_images/reaper-cluster.png" />
<p>Here is the datacenter spec to configure Cassandra reaper deployment:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
</colgroup>
<tbody>
<tr class="row-odd"><td colspan="6"><p><a class="reference external" href="urn:jsonschema:com:strapdata:strapkop:model:k8s:datacenter:Reaper">urn:jsonschema:com:strapdata:strapkop:model:k8s:datacenter:Reaper</a></p></td>
</tr>
<tr class="row-even"><td colspan="6"><p>Cassandra reaper configuration</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td colspan="5"><p><em>object</em></p></td>
</tr>
<tr class="row-even"><td colspan="6"><p>properties</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><ul class="simple">
<li><p>image</p></li>
</ul>
</td>
<td colspan="5"><p>reaper docker image</p></td>
</tr>
<tr class="row-even"><td><p>type</p></td>
<td colspan="4"><p><em>string</em></p></td>
</tr>
<tr class="row-odd"><td rowspan="3"><ul class="simple">
<li><p>podTemplate</p></li>
</ul>
</td>
<td colspan="5"><p>Reaper pods template allowing customisation</p></td>
</tr>
<tr class="row-even"><td><p>type</p></td>
<td colspan="4"><p><em>object</em></p></td>
</tr>
<tr class="row-odd"><td colspan="5"><p><span class="xref std std-ref">urn:jsonschema:io:kubernetes:client:openapi:models:V1PodTemplateSpec</span></p></td>
</tr>
<tr class="row-even"><td rowspan="2"><ul class="simple">
<li><p>jwtSecret</p></li>
</ul>
</td>
<td colspan="5"><p>Reaper JWT secret</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td colspan="4"><p><em>string</em></p></td>
</tr>
<tr class="row-even"><td rowspan="2"><ul class="simple">
<li><p>enabled</p></li>
</ul>
</td>
<td colspan="5"><p>Reaper enabled</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td colspan="4"><p><em>boolean</em></p></td>
</tr>
<tr class="row-even"><td rowspan="2"><ul class="simple">
<li><p>loggingLevel</p></li>
</ul>
</td>
<td colspan="5"><p>Reaper logging level</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td colspan="4"><p><em>string</em></p></td>
</tr>
<tr class="row-even"><td rowspan="2"><ul class="simple">
<li><p>ingressHost</p></li>
</ul>
</td>
<td colspan="5"><p>Reaper ingress host</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td colspan="4"><p><em>string</em></p></td>
</tr>
<tr class="row-even"><td rowspan="2"><ul class="simple">
<li><p>ingressAdminHost</p></li>
</ul>
</td>
<td colspan="5"><p>Reaper admin ingress host</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td colspan="4"><p><em>string</em></p></td>
</tr>
<tr class="row-even"><td rowspan="3"><ul class="simple">
<li><p>ingressAnnotations</p></li>
</ul>
</td>
<td colspan="5"><p>Reaper ingress annotations</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td colspan="4"><p><em>object</em></p></td>
</tr>
<tr class="row-even"><td><p>additionalProperties</p></td>
<td><p>type</p></td>
<td colspan="3"><p><em>string</em></p></td>
</tr>
<tr class="row-odd"><td rowspan="21"><ul class="simple">
<li><p>scheduledRepairs</p></li>
</ul>
</td>
<td colspan="5"><p>Reaper scheduled repairs configuration</p></td>
</tr>
<tr class="row-even"><td><p>type</p></td>
<td colspan="4"><p><em>array</em></p></td>
</tr>
<tr class="row-odd"><td colspan="5"><p>items</p></td>
</tr>
<tr class="row-even"><td rowspan="18"><ul class="simple">
<li></li>
</ul>
</td>
<td><p>type</p></td>
<td colspan="3"><p><em>object</em></p></td>
</tr>
<tr class="row-odd"><td colspan="4"><p>properties</p></td>
</tr>
<tr class="row-even"><td><ul class="simple">
<li><p>owner</p></li>
</ul>
</td>
<td><p>type</p></td>
<td colspan="2"><p><em>string</em></p></td>
</tr>
<tr class="row-odd"><td><ul class="simple">
<li><p>keyspace</p></li>
</ul>
</td>
<td><p>type</p></td>
<td colspan="2"><p><em>string</em></p></td>
</tr>
<tr class="row-even"><td rowspan="3"><ul class="simple">
<li><p>tables</p></li>
</ul>
</td>
<td><p>type</p></td>
<td colspan="2"><p><em>array</em></p></td>
</tr>
<tr class="row-odd"><td colspan="3"><p>items</p></td>
</tr>
<tr class="row-even"><td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>type</p></td>
<td><p><em>string</em></p></td>
</tr>
<tr class="row-odd"><td rowspan="3"><ul class="simple">
<li><p>blacklistedTables</p></li>
</ul>
</td>
<td><p>type</p></td>
<td colspan="2"><p><em>array</em></p></td>
</tr>
<tr class="row-even"><td colspan="3"><p>items</p></td>
</tr>
<tr class="row-odd"><td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>type</p></td>
<td><p><em>string</em></p></td>
</tr>
<tr class="row-even"><td><ul class="simple">
<li><p>segmentCount</p></li>
</ul>
</td>
<td><p>type</p></td>
<td colspan="2"><p><em>integer</em></p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><ul class="simple">
<li><p>repairParallelism</p></li>
</ul>
</td>
<td><p>type</p></td>
<td colspan="2"><p><em>string</em></p></td>
</tr>
<tr class="row-even"><td><p>enum</p></td>
<td colspan="2"><p>SEQUENTIAL, PARALLEL, DATACENTER_AWARE</p></td>
</tr>
<tr class="row-odd"><td><ul class="simple">
<li><p>intensity</p></li>
</ul>
</td>
<td><p>type</p></td>
<td colspan="2"><p><em>number</em></p></td>
</tr>
<tr class="row-even"><td><ul class="simple">
<li><p>incrementalRepair</p></li>
</ul>
</td>
<td><p>type</p></td>
<td colspan="2"><p><em>boolean</em></p></td>
</tr>
<tr class="row-odd"><td><ul class="simple">
<li><p>scheduleDaysBetween</p></li>
</ul>
</td>
<td><p>type</p></td>
<td colspan="2"><p><em>integer</em></p></td>
</tr>
<tr class="row-even"><td><ul class="simple">
<li><p>scheduleTriggerTime</p></li>
</ul>
</td>
<td><p>type</p></td>
<td colspan="2"><p><em>string</em></p></td>
</tr>
<tr class="row-odd"><td><ul class="simple">
<li><p>repairThreadCount</p></li>
</ul>
</td>
<td><p>type</p></td>
<td colspan="2"><p><em>integer</em></p></td>
</tr>
</tbody>
</table>
<p>The Elassandra Operator deploys one Cassandra Reaper instance per datacenter
(see <a class="reference external" href="http://cassandra-reaper.io/docs/usage/multi_dc_distributed/">Operating Multiple DCs using Multiple Reaper</a>),
with datacenterAvailability=EACH, JMX connections to local nodes only.</p>
<p>You can enable/disable the Cassandra Reaper deployment by updating the Elassandra datacenter spec as show in
the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">helm</span> <span class="n">upgrade</span> <span class="o">--</span><span class="n">reuse</span><span class="o">-</span><span class="n">values</span> <span class="o">--</span><span class="nb">set</span> <span class="n">reaper</span><span class="o">.</span><span class="n">enabled</span><span class="o">=</span><span class="n">true</span> <span class="n">default</span><span class="o">-</span><span class="n">cl1</span><span class="o">-</span><span class="n">dc1</span> <span class="n">strapdata</span><span class="o">/</span><span class="n">elassandra</span><span class="o">-</span><span class="n">datacenter</span>
</pre></div>
</div>
<div class="section" id="address-translation">
<h3>Address translation<a class="headerlink" href="#address-translation" title="Permalink to this headline">¶</a></h3>
<p>When your Elassandra/Cassandra cluster use Kubernetes node’s public IP address,
application deployed in the same Kubernetes cluster using the Cassandra driver should use a
<a class="reference external" href="https://docs.datastax.com/en/developer/java-driver/3.7/manual/address_resolution/">Driver-side Address Translation</a> to connect to Elassandra/Cassandra nodes
using their internal IP.</p>
<p>This is the case of the deployed Cassandra Reaper instance which use Elassandra to store various data to manage continuous repairs,
but also for any application you may deploy in the same Kubernetes cluster.</p>
<p>So we provide an <a class="reference external" href="https://docs.datastax.com/en/developer/java-driver/3.7/manual/address_resolution/">AddressTranslator</a>
implementation <strong>KubernetesDnsAddressTranslator</strong> using the DNS resolution to translate the public broadcast IP address to the internal IP address,
installed for Cassandra Reaper.</p>
<p>This <strong>KubernetesDnsAddressTranslator</strong> works in two ways:</p>
<ul class="simple">
<li><p>If the env variable <code class="docutils literal notranslate"><span class="pre">ADDRESS_TRANSLATOR_DNS_DOMAIN</span></code> is defined, the <strong>KubernetesDnsAddressTranslator</strong> convert the public address X.X.X.X
to the DNS name X-X-X-X.$ADDRESS_TRANSLATOR_DNS_DOMAIN and try to resolve it to get the internal node IP address.</p></li>
<li><p>If the <code class="docutils literal notranslate"><span class="pre">ADDRESS_TRANSLATOR_DNS_DOMAIN</span></code> is not defined or the resolution failed, the KubernetesDnsAddressTranslator try to
revers lookup the public IP to get the internal Kubernetes node name. Then it resolves the Kubernetes node name to its internal IP address.</p></li>
</ul>
<p>To achieve this behavior, you may need to deploy <a class="reference external" href="https://coredns.io/">CoreDNS</a> in your Kubernetes cluster,
with the <a class="reference external" href="https://coredns.io/plugins/hosts/">hosts plugin</a>
properly configured to reverse lookup public IP addresses of Kubernetes nodes internal IP addresses.</p>
</div>
</div>
<div class="section" id="kibana-visualisation">
<h2>Kibana visualisation<a class="headerlink" href="#kibana-visualisation" title="Permalink to this headline">¶</a></h2>
<p>In order to visualize your Elassandra data, or interact with Elasticsearch, the Elassandra-Operator can deploy
secured Kibana instances pointing to your Elassandra datacenter nodes.</p>
<img alt="_images/kibana-cluster-state.png" src="_images/kibana-cluster-state.png" />
<p>When Elasticsearch HTTPS is enabled in your Elassandra datacenter, Kibana is automatically configured to connect
through HTTPS and trust the Elassandra datacenter root CA. Moreover, for each Kibana space, the Elassandra-Operator
creates a dedicated Cassandra role and a dedicated managed keyspace storing the kibana configuration.
Thus, you can run separated kibana instances dedicated to specific usages or specific users.</p>
<p>Here is the datacenter spec to configure kibana deployment:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
</colgroup>
<tbody>
<tr class="row-odd"><td colspan="6"><p><a class="reference external" href="urn:jsonschema:com:strapdata:strapkop:model:k8s:datacenter:Kibana">urn:jsonschema:com:strapdata:strapkop:model:k8s:datacenter:Kibana</a></p></td>
</tr>
<tr class="row-even"><td colspan="6"><p>Kibana configuration</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td colspan="5"><p><em>object</em></p></td>
</tr>
<tr class="row-even"><td colspan="6"><p>properties</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><ul class="simple">
<li><p>image</p></li>
</ul>
</td>
<td colspan="5"><p>Kibana docker image</p></td>
</tr>
<tr class="row-even"><td><p>type</p></td>
<td colspan="4"><p><em>string</em></p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><ul class="simple">
<li><p>enabled</p></li>
</ul>
</td>
<td colspan="5"><p>Kibana enabled, default is true</p></td>
</tr>
<tr class="row-even"><td><p>type</p></td>
<td colspan="4"><p><em>boolean</em></p></td>
</tr>
<tr class="row-odd"><td rowspan="27"><ul class="simple">
<li><p>spaces</p></li>
</ul>
</td>
<td colspan="5"><p>Kibana user spaces</p></td>
</tr>
<tr class="row-even"><td><p>type</p></td>
<td colspan="4"><p><em>array</em></p></td>
</tr>
<tr class="row-odd"><td colspan="5"><p>items</p></td>
</tr>
<tr class="row-even"><td rowspan="24"><ul class="simple">
<li></li>
</ul>
</td>
<td><p>type</p></td>
<td colspan="3"><p><em>object</em></p></td>
</tr>
<tr class="row-odd"><td colspan="4"><p>properties</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><ul class="simple">
<li><p>name</p></li>
</ul>
</td>
<td colspan="3"><p>Kibana space name (default is “”)</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td colspan="2"><p><em>string</em></p></td>
</tr>
<tr class="row-even"><td rowspan="4"><ul class="simple">
<li><p>keyspaces</p></li>
</ul>
</td>
<td colspan="3"><p>Kibana visible keyspaces</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td colspan="2"><p><em>array</em></p></td>
</tr>
<tr class="row-even"><td colspan="3"><p>items</p></td>
</tr>
<tr class="row-odd"><td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>type</p></td>
<td><p><em>string</em></p></td>
</tr>
<tr class="row-even"><td rowspan="4"><ul class="simple">
<li><p>statements</p></li>
</ul>
</td>
<td colspan="3"><p>Kibana authorization statements</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td colspan="2"><p><em>array</em></p></td>
</tr>
<tr class="row-even"><td colspan="3"><p>items</p></td>
</tr>
<tr class="row-odd"><td><ul class="simple">
<li></li>
</ul>
</td>
<td><p>type</p></td>
<td><p><em>string</em></p></td>
</tr>
<tr class="row-even"><td rowspan="2"><ul class="simple">
<li><p>replicas</p></li>
</ul>
</td>
<td colspan="3"><p>Number of kibana instance, default is 1</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td colspan="2"><p><em>integer</em></p></td>
</tr>
<tr class="row-even"><td rowspan="2"><ul class="simple">
<li><p>ingressSuffix</p></li>
</ul>
</td>
<td colspan="3"><p>Kibana space ingress suffix so that ingress host = {spaceName}-{ingressSuffix}</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td colspan="2"><p><em>string</em></p></td>
</tr>
<tr class="row-even"><td rowspan="3"><ul class="simple">
<li><p>ingressAnnotations</p></li>
</ul>
</td>
<td colspan="3"><p>Kibana space ingress annotations</p></td>
</tr>
<tr class="row-odd"><td><p>type</p></td>
<td colspan="2"><p><em>object</em></p></td>
</tr>
<tr class="row-even"><td><p>additionalProperties</p></td>
<td><p>type</p></td>
<td><p><em>string</em></p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><ul class="simple">
<li><p>version</p></li>
</ul>
</td>
<td colspan="3"><p>Kibana space Elasticsearch upgrade version</p></td>
</tr>
<tr class="row-even"><td><p>type</p></td>
<td colspan="2"><p><em>integer</em></p></td>
</tr>
<tr class="row-odd"><td rowspan="3"><ul class="simple">
<li><p>podTemplate</p></li>
</ul>
</td>
<td colspan="3"><p>Kibana pod template allowing customisation</p></td>
</tr>
<tr class="row-even"><td><p>type</p></td>
<td colspan="2"><p><em>object</em></p></td>
</tr>
<tr class="row-odd"><td colspan="3"><p><span class="xref std std-ref">urn:jsonschema:io:kubernetes:client:openapi:models:V1PodTemplateSpec</span></p></td>
</tr>
</tbody>
</table>
<p>You can enable/disable the Kibana deployment by updating the Elassandra datacenter spec as show in
the following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">helm</span> <span class="n">upgrade</span> <span class="o">--</span><span class="n">reuse</span><span class="o">-</span><span class="n">values</span> <span class="o">--</span><span class="nb">set</span> <span class="n">kibana</span><span class="o">.</span><span class="n">enabled</span><span class="o">=</span><span class="n">true</span> <span class="n">default</span><span class="o">-</span><span class="n">cl1</span><span class="o">-</span><span class="n">dc1</span> <span class="n">strapdata</span><span class="o">/</span><span class="n">elassandra</span><span class="o">-</span><span class="n">datacenter</span>
</pre></div>
</div>
<p>You can also adjust Kibana memory by adding the following podTemplate to set environment variables or customize resources:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">kibana</span><span class="p">:</span>
  <span class="n">spaces</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="s2">&quot;default&quot;</span>
    <span class="n">podTemplate</span><span class="p">:</span>
      <span class="n">spec</span><span class="p">:</span>
        <span class="n">containers</span><span class="p">:</span>
        <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">kibana</span>
          <span class="n">env</span><span class="p">:</span>
          <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="n">NODE_OPTIONS</span>
            <span class="n">value</span><span class="p">:</span> <span class="s2">&quot;--max-old-space-size=4096&quot;</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="operations.html" class="btn btn-neutral float-right" title="Operations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="provisioning.html" class="btn btn-neutral float-left" title="Provision a Datacenter" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Strapdata

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>